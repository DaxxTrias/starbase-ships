---
layout: layouts/base
---
<nord-header slot="header">
  <nord-stack direction="horizontal" wrap>
    <nord-button-group>
      {% for shipType in ships.types.list %}
        <nord-button href="#{{shipType.id}}" size="s" variant="plain">{{shipType.label}}</nord-button>
      {% endfor %}

      <nord-button class="search-button" aria-describedby="tt-search" size="s" variant="plain">
        <span slot="start" class="nordicon n-size-icon-m">{{ "/node_modules/@nordhealth/icons/lib/assets/navigation-search.svg" | svgContents | safe }}</span>
      </nord-button>
      <nord-tooltip id="tt-search">Search ships by name and/or tags</nord-tooltip>
    </nord-button-group>
    <nord-toggle id="ship-filters-toggle" label="Filters" value="show" size="s"></nord-toggle>
  </nord-stack>
</nord-header>
<nord-drawer id="ship-filters" slot="drawer">
  <nord-header slot="header">
    <h3>Ship Filters</h3>
    <nord-button slot="end" id="reset-ship-filters" size="s">
      Reset
    </nord-button>
  </nord-header>
  <nord-stack>
    <p class="n-color-text-weaker n-font-size-s">Sale Type</p>
    <nord-stack>
      <nord-checkbox class="ship-filter ship-filter-sale-type" label="Free" value="free"></nord-checkbox>
      <nord-checkbox class="ship-filter ship-filter-sale-type" label="For Sale" value="for-sale"></nord-checkbox>
    </nord-stack>
  </nord-stack>
  <nord-stack>
    <p class="n-color-text-weaker n-font-size-s n-padding-bs-l">Ship Type</p>
    <nord-stack>
      {% for shipType in ships.types.list %}
        <nord-checkbox class="ship-filter ship-filter-type" label="{{shipType.label}}" value="{{shipType.id}}"></nord-checkbox>
      {% endfor %}
    </nord-stack>
  </nord-stack>
  <nord-stack>
    <p class="n-color-text-weaker n-font-size-s n-padding-bs-l">Ship Tag</p>
    <nord-stack>
      {% for tag in ships.tags.list %}
        <nord-checkbox class="ship-filter ship-filter-tag" label="{{tag.label}}" value="{{tag.id}}"></nord-checkbox>
      {% endfor %}
    </nord-stack>
  </nord-stack>
</nord-drawer>
<script>
  const toggle = document.querySelector("#ship-filters-toggle");
  const filters = document.querySelector("#ship-filters");
  filters.remove();
  toggle.addEventListener('change', (event) => {
    if (event.target.checked) {
      document.querySelector('nord-layout').appendChild(filters);
      document.querySelectorAll('.ship-filter')
        .forEach((item) => {
          item.addEventListener('change', (event) => {
            applyFilters();
          });
        });

      document
        .querySelector('#reset-ship-filters')
        .addEventListener('click', resetFilters);
    } else {
      filters.remove();
    }
    applyFilters();
  });

  const resetFilters = () => {
    document.querySelectorAll('.ship-filter').forEach((item) => {
        item.checked = false;
    });
    applyFilters();
  };

  const applyFilters = () => {
    document.querySelectorAll('.ship-card').forEach((item) => {
      item.classList.add('hide');
    });

    const shipsToShow = ships
      .filter((ship) => {
        const saleTypes = document.querySelectorAll('.ship-filter-sale-type').values().filter((item) => item.checked).map(({ value }) => value).toArray();
        return !saleTypes.length || saleTypes.includes(ship.saleType)
      }).filter((ship) => {
        const types = document.querySelectorAll('.ship-filter-type').values().filter((item) => item.checked).map(({ value }) => value).toArray();
        return !types.length || ship.types.some(({ type }) => types.includes(type))
      }).filter((ship) => {
        const tags = document.querySelectorAll('.ship-filter-tag').values().filter((item) => item.checked).map(({ value }) => value).toArray();
        return !tags.length || ship.tags.some(({ id }) => tags.includes(id))
      });

    shipsToShow.forEach((ship) => {
      document.querySelectorAll(`.ship-${ship.slug}`).forEach((card) => card.classList.remove('hide'));
    });

    document.querySelectorAll('.ship-section').forEach((section) => {
      const shipCards = section.querySelectorAll('.ship-card');
      const hiddenShipCards = section.querySelectorAll('.ship-card.hide');
      if (shipCards.length === hiddenShipCards.length) {
        section.classList.add('hide');
        return;
      }
      section.classList.remove('hide');
    })

    document.querySelector('.reset-ship-filters').classList.add('hide');
    if (shipsToShow.length === 0) document.querySelector('.reset-ship-filters').classList.remove('hide');
  };
</script>
<nord-stack gap="l" class="n-padding-i-l n-padding-b-l">
  <nord-stack gap="l" class="n-padding-i-l n-padding-b-l" style="min-width: 900px; width: 900px;">
    <nord-card padding="none">
      <nord-stack direction="horizontal" justify-content="center" align-items="stretch">
        <nord-stack direction="horizontal" justify-content="center" align-items="stretch">
          <img src="{{ 'images/logos/egotech_logo_dark_transparent.png' | url }}" alt="EGOTech Logo" />
        </nord-stack>
        <nord-divider direction="vertical"></nord-divider>
        <nord-stack direction="vertical" align-items="stretch" class="n-padding-i-l n-padding-b-l">
          <h1>EGOTech</h1>
          <p class="n-font-size-l">
            EGOTech thrives to design various types of Starbase ships that are practical but fun to use.
            Free blueprints are available for download with premium versions available for sale for in game credits.
          </p>
          <a href="https://discord.gg/BKwVGvncmN">
            <img alt="EGOTech Discord Server" src="https://camo.githubusercontent.com/a52557e3b6648630b7bf1f530c22745e510cbed885cff0c1e11fccb64e9c61da/68747470733a2f2f646973636f72646170702e636f6d2f6170692f6775696c64732f313031333332383638353536343137383437322f7769646765742e706e673f7374796c653d62616e6e657232" />
          </a>
          <nord-banner variant="info">
            <p class="n-font-size-m">
              <a href="https://www.starbasegame.com/">Starbase</a> is a MMO game developed by <a href="https://www.frozenbyte.com/">Frozenbyte</a>.
            </p>
        </nord-banner>
        </nord-stack>
      </nord-stack>
    </nord-card>
  </nord-stack>
  <nord-stack class="reset-ship-filters n-padding-i-l n-padding-b-l hide" style="max-width: 1200px;"">
    <nord-card>
      <nord-empty-state>
        <h2>No ships found</h2>
        <p>Try adjusting your filter options to find what youâ€™re looking for.</p>
        <nord-button variant="primary">Clear filters</nord-button>
      </nord-empty-state>
    </nord-card>
  </nord-stack>
  <script>
    document
      .querySelector('.reset-ship-filters')
      .addEventListener('click', resetFilters);
  </script>
  {% for shipType in ships.types.list %}
    <nord-stack class="ship-section">
      <nord-stack gap="l" class="n-padding-i-l n-padding-b-l">
        <h1 id="{{shipType.id}}">{{shipType.label}}</h1>
        <nord-stack direction="horizontal" wrap>
        {% for ship in ships.byType[shipType.id] %}
          <nord-card class="ship-card ship-{{ship.slug}}" padding="none" style="width: 435px;">
            <h1 slot="header">{{ship.name}}</h1>
            <span slot="header-end">
              {% include 'shipVersion.njk' %}
            </span>
            <nord-stack style="width: 435px; height: 220px; overflow: hidden;">
              {% set photo = ship.photos | selectattr('featured') | first %}
              <img src="{{photo.url}}" alt="{{photo.description or photo.filename}}" />
            </nord-stack>
            <nord-stack gap="none">
              {% for feature in ship.features %}
                <nord-stack direction="horizontal" align-items="stretch" class="n-padding-is-m n-padding-b-s n-border-be n-color-surface-raised">
                  <nord-stack>{{feature.label}}</nord-stack>
                  <nord-stack style="text-align: right;" class="n-padding-ie-m">
                    {% if feature.unit !== undefined %}
                      {{feature.value.toLocaleString()}} {{feature.unit}}
                    {% else %}
                      {{feature.value}}
                    {% endif %}
                  </nord-stack>
                </nord-stack>
              {% endfor %}
            </nord-stack>
            <nord-stack class="n-padding-i-m n-padding-b-m">
              <p>{{ ship.shortDescription | nl2br | safe }}</p>
            </nord-stack>
            <div slot="footer">
              {% include 'shipTags.njk' %}
            </div>
            <div slot="footer" class="n-margin-bs-l">
              <nord-stack>
                <nord-button variant="primary" href="{{ ('/ships/' + ship.slug + '/') | url }}" expand>View</nord-button>
              </nord-stack>
            </div>
          </nord-card>
        {% endfor %}
        </nord-stack>
      </nord-stack>
      <nord-divider></nord-divider>
    </nord-stack>
  {% endfor %}
</nord-stack>
